# Project Context: PDF Frame Viewer WordPress Plugin

This document summarizes key aspects of the `pdf-frame-viewer` WordPress plugin, including development workflow, implemented features, and deferred/discussed items. This helps maintain continuity and provides quick context for future development sessions.

---

## 1. Development & Deployment Workflow

**Local Environment:** Local by WP Engine
**Version Control:** Git & GitHub (`https://github.com/webninja4/pdf-frame-viewer.git`)

**Deployment Process (to Cloudways):
1.  **Local Changes:** Make code changes in the plugin directory.
2.  **Commit Locally:**
    ```bash
    git add .
    git commit -m "Your descriptive commit message"
    ```
3.  **Push to GitHub:**
    ```bash
    git push origin main
    ```
4.  **Deploy to Production (Choose ONE):
    *   **Option A (Recommended for now): Cloudways UI Pull**
        *   Log into Cloudways Panel.
        *   Navigate to your Application -> Deployment via Git.
        *   Click the "Pull" or "Deploy Now" button to fetch the latest changes from GitHub.
    *   **Option B (Manual SSH Pull - if Cloudways UI is unavailable):
        *   SSH into your Cloudways server using Master Credentials:
            ```bash
            ssh YOUR_MASTER_USERNAME@YOUR_SERVER_IP_OR_DOMAIN
            ```
        *   Navigate to the plugin directory:
            ```bash
            cd /home/YOUR_MASTER_USERNAME/applications/YOUR_APPLICATION_FOLDER_NAME/public_html/wp-content/plugins/pdf-frame-viewer
            ```
        *   Pull the latest changes:
            ```bash
            git pull origin main
            ```

---

## 2. Implemented Features & Fixes

### **Core Functionality Enhancements:**

*   **AJAX Search for Media Library PDFs:**
    *   Replaced the static dropdown with a dynamic search input.
    *   Implemented a PHP AJAX endpoint (`wp_ajax_search_pdfs`) to query PDF attachments by search term.
    *   Displays search results with PDF filename and upload date in a styled list.
    *   Clicking a result loads the PDF into the viewer.
*   **Limited Initial PDF List:**
    *   The initial list of PDFs displayed in the media library search area is limited to the 10 most recently uploaded.

### **Bug Fixes & Improvements:**

*   **PDF.js Worker Version Mismatch:**
    *   Resolved the "API version does not match Worker version" error by replacing `lib/pdfjs/build/pdf.worker.js` with the correct version (3.2.146) matching `pdf.js`.
*   **HTTPS URL Generation:**
    *   Ensured that shortcodes generated by the Classic Editor and Gutenberg sidebar use `https://` for PDF URLs, preventing mixed-content issues on secure sites.
*   **Editor Functionality Scope:**
    *   Limited the appearance of the "Add Split View PDF" button and related editor scripts (for both Classic and Block editors) to only WordPress **Pages**. They no longer appear on Posts, Custom Post Types (CPTs), or other admin screens.

### **Document Library Pro Integration:**

*   **Dynamic PDF Frame Viewer Links:**
    *   Implemented integration with Document Library Pro plugin in the child theme (`functions.php`).
    *   Added automatic "Open in PDF Frame View" button on Document CPT single pages.
    *   Button only appears for documents with PDF file extensions.
    *   Links to a dedicated viewer page with the `[dynamic_pdf_viewer]` shortcode.
    *   Includes secure URL handling and validation.

---

## 3. Deferred / Discussed Items

*   **Automated Deployment via Cloudways API / GitHub Actions:**
    *   Discussed as the ideal "seamless" deployment method. Requires setting up a GitHub Action to trigger a Cloudways API endpoint. Deferred for future implementation.
*   **Xdebug Setup in Cursor:**
    *   Discussed the process for setting up Xdebug with Local by WP Engine and Cursor for PHP debugging. Deferred for later setup by the user.
*   **Relevanssi Pro Integration for PDF Search:**
    *   Considered for enhancing PDF search capabilities, but decided to proceed with standard `WP_Query` for initial implementation. Could be revisited if search results need further refinement.

---
